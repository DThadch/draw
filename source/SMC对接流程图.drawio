<mxfile host="app.diagrams.net" modified="2022-10-30T11:37:37.040Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36" etag="UUfzNo-KZeWzfJK9-gd3" version="20.4.1" type="github">
  <diagram name="Page-1" id="edf60f1a-56cd-e834-aa8a-f176f3a09ee4">
    <mxGraphModel dx="905" dy="591" grid="0" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1700" pageHeight="1100" background="none" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-1" target="-ZdTm5bZnZh4pB2H1c_u-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-1" value="开始" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="90" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-2" target="-ZdTm5bZnZh4pB2H1c_u-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-2" value="切换特步媒介数据体系，根据当前登录用户的权限展示SMC人群画像推送入口" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="164" y="197" width="172" height="59" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-3" target="-ZdTm5bZnZh4pB2H1c_u-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-3" value="cdp-web程序提交人群计算任务（主要参数为人群的code和设备类型）至job-scheduler程序，这里有四种设备类型，所以一次会触发提交四个人群计算任务" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="118" y="408" width="264" height="64" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-4" target="-ZdTm5bZnZh4pB2H1c_u-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-4" value="选择CDP推送人群" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="190" y="308" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-7" target="-ZdTm5bZnZh4pB2H1c_u-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-7" value="job-scheduler程序解析参数，并且将人群计算任务提交至azkaban" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="164" y="512" width="180" height="64" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-10" target="-ZdTm5bZnZh4pB2H1c_u-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-10" value="azkaban触发spark人群计算任务，根据人群code去hbase取出人群offset的文件在hdfs上的地址，拿到offset和hive中的idmapping_3表匹配拿出one_id，再通过one_id&amp;nbsp; by 设备类型分别生产不同的csv文件存入hdfs" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="52.5" y="621" width="403" height="82" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-12" target="-ZdTm5bZnZh4pB2H1c_u-15">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="435" y="777" as="targetPoint" />
            <Array as="points">
              <mxPoint x="514" y="777" />
              <mxPoint x="514" y="514" />
              <mxPoint x="704" y="514" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-12">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="254" y="864.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-12" value="是否执行成功" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="168.5" y="737" width="171" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-15" target="-ZdTm5bZnZh4pB2H1c_u-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-15" value="更新数据库中人群计算状态为成功，并且往数据库插入推送至smc的临时人群文件地址，往kafka指定队列中生产一条数据标志此次人群计算任务完成" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="581" y="534" width="246" height="72" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-16" value="是" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="432" y="752" width="30" height="26" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-18" value="否" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="260" y="824" width="30" height="26" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-19" target="-ZdTm5bZnZh4pB2H1c_u-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-19" value="更新数据库中人群计算状态为失败，往kafka指定队列中生产一条数据标志此次人群计算任务完成" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="161" y="867" width="186" height="66" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-20" target="-ZdTm5bZnZh4pB2H1c_u-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-20" value="返回业务异常，标志推送失败" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="194" y="966" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-21" value="结束" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="213.5" y="1054" width="81" height="41" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-24" target="-ZdTm5bZnZh4pB2H1c_u-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-24" value="cdp-web程序中定时任务轮询，如果该人群的四个计算任务都成功，就拿到四个集群计算任务生成的人群文件，推送至SMC，等待SMC回调" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="600.5" y="663" width="207" height="85" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-26" target="-ZdTm5bZnZh4pB2H1c_u-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-26" target="-ZdTm5bZnZh4pB2H1c_u-31">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-26" value="SMC回调是否成功" style="rhombus;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="628" y="801" width="152" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-29" value="否" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="551" y="812" width="30" height="26" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-33" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="-ZdTm5bZnZh4pB2H1c_u-31" target="-ZdTm5bZnZh4pB2H1c_u-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="-ZdTm5bZnZh4pB2H1c_u-31" value="记录回调信息至数据库，页面点击SMC推送列表，可根据当前登录的用户权限跳转至SMC查看具体的人群或者画像" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="612.5" y="916" width="183" height="65" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
